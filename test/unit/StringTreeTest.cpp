/*
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

//@lint-ignore-every

#include <gtest/gtest.h>

#include "RedexTest.h"
#include "StringTreeSet.h"

struct StringTreeTest : public RedexTest {};

static std::string toHexRepresentation(const std::string& str) {
  std::ostringstream hex_str;
  for (char c : str) {
    hex_str << std::hex << std::setw(2) << std::setfill('0')
            << static_cast<int>(c);
  }
  std::string hex = hex_str.str();
  return hex;
}

TEST_F(StringTreeTest, testEncode) {
  std::vector<std::string> class_names = {
      "com.facebook.location.platform.api.LocationRequest",
      "com.facebook.contacts.picker.ContactPickerRowVisitor",
      "com.facebook.payments.checkout.configuration.model."
      "CheckoutTermsAndPolicies",
      "com.facebook.photos.albums.fragment.AlbumMediaPickerController",
      "com.facebookpay.msc.listsection.item.controller.DividerItemDataModel",
      "com.facebook.optic.util.ExifReader",
      "com.facebook.facecast.event.model.FacecastPromoEvent$Deserializer",
      "com.facebook.timeline.gemstone.overlay.LoggingOverlayAdapter$"
      "LoggingOverlayItemViewHolder",
      "com.facebook.storelocator.StoreLocatorCardProvider$2",
      "com.facebook.inspiration.avatars."
      "InspirationAvatarsBackgroundTopBarController$3",
      "com.facebook.contacts.model.PhonebookPhoneNumber",
      "com.facebook.keyframes.decoder.icons.IconDocument$KFSize",
      "com.facebook.nativetemplates.fb.action.eventopen.FBEventOpenAction",
      "com.facebook.pages.common.requesttime.calendar.components."
      "ServicesProfilePictureComponent",
      "com.facebook.account.switcher.nux.TargetedNuxResolver$1",
      "com.facebook.common.exceptionhandler."
      "UserInitiatedExpectedAppExitException",
      "com.facebook.rtc.logging.api.interfaces.RtcNotificationImpressionLog",
      "com.facebook.composer.ui.popover.CreationPopoverListView$ShowAnimation",
      "com.facebook.composer.audienceeducator.ComposerAudienceEducatorData$"
      "TagExpansionExplanationType",
      "com.facebook.messaging.business.customerfeedback.model."
      "CustomerFeedbackPageData",
      "com.facebook.messaging.customthreads.model.ThreadThemeInfo",
      "com.facebook.adinterfaces.AdInterfacesCouponInterstitialActivity",
      "com.facebook.audience.stories.highlights.settings.protocol."
      "FetchStoriesHighlightsSettingsGraphQLModels$"
      "StoriesHighlightsPrivacySettingsTreeModel$StoriesDataTreeModel$"
      "StoryHighlightPreferencesTreeModel"};

  std::string encoded = StringTreeSet::encode_string_tree_set(class_names);

  std::string hex = toHexRepresentation(encoded);

  EXPECT_EQ(
      hex,
      "636f6d2e66616365626f6f6b042e70630b011a616366030166770501692c06016b6e0601"
      "6c1a07016d3f07016e2a08016f5f08017074080172380a01736f0a0174170b0106636478"
      "0101752b0201636f756e742e73776974636865722e6e75782e54617267657465644e7578"
      "5265736f6c766572243101696e74657266616365732e4164496e7465726661636573436f"
      "75706f6e496e7465727374697469616c4163746976697479016469656e63652e73746f72"
      "6965732e686967686c69676874732e73657474696e67732e70726f746f636f6c2e466574"
      "636853746f72696573486967686c696768747353657474696e67734772617068514c4d6f"
      "64656c732453746f72696573486967686c69676874735072697661637953657474696e67"
      "73547265654d6f64656c2453746f7269657344617461547265654d6f64656c2453746f72"
      "79486967686c69676874507265666572656e636573547265654d6f64656c016f046d6e33"
      "0501046d702e04016f6e2e657863657074696f6e68616e646c65722e55736572496e6974"
      "6961746564457870656374656441707045786974457863657074696f6e016f7365722e04"
      "6175030501756469656e63656564756361746f722e436f6d706f73657241756469656e63"
      "654564756361746f724461746124546167457870616e73696f6e4578706c616e6174696f"
      "6e5479706501692e706f706f7665722e4372656174696f6e506f706f7665724c69737456"
      "6965772453686f77416e696d6174696f6e0174616374732e046d705905016f64656c2e50"
      "686f6e65626f6f6b50686f6e654e756d6265720169636b65722e436f6e74616374506963"
      "6b6572526f7756697369746f7201616365636173742e6576656e742e6d6f64656c2e4661"
      "63656361737450726f6d6f4576656e7424446573657269616c697a6572016e7370697261"
      "74696f6e2e617661746172732e496e737069726174696f6e417661746172734261636b67"
      "726f756e64546f70426172436f6e74726f6c6c657224330165796672616d65732e646563"
      "6f6465722e69636f6e732e49636f6e446f63756d656e74244b4653697a65016f63617469"
      "6f6e2e706c6174666f726d2e6170692e4c6f636174696f6e526571756573740165737361"
      "67696e672e0462630708017573696e6573732e637573746f6d6572666565646261636b2e"
      "6d6f64656c2e437573746f6d6572466565646261636b5061676544617461017573746f6d"
      "746872656164732e6d6f64656c2e5468726561645468656d65496e666f01617469766574"
      "656d706c617465732e66622e616374696f6e2e6576656e746f70656e2e46424576656e74"
      "4f70656e416374696f6e01707469632e7574696c2e457869665265616465720104616808"
      "0a010467794b090165732e636f6d6d6f6e2e7265717565737474696d652e63616c656e64"
      "61722e636f6d706f6e656e74732e536572766963657350726f66696c6550696374757265"
      "436f6d706f6e656e74016d656e74732e636865636b6f75742e636f6e6669677572617469"
      "6f6e2e6d6f64656c2e436865636b6f75745465726d73416e64506f6c6963696573016f74"
      "6f732e616c62756d732e667261676d656e742e416c62756d4d656469615069636b657243"
      "6f6e74726f6c6c65720174632e6c6f6767696e672e6170692e696e74657266616365732e"
      "5274634e6f74696669636174696f6e496d7072657373696f6e4c6f6701746f72656c6f63"
      "61746f722e53746f72654c6f6361746f724361726450726f7669646572243201696d656c"
      "696e652e67656d73746f6e652e6f7665726c61792e4c6f6767696e674f7665726c617941"
      "646170746572244c6f6767696e674f7665726c61794974656d56696577486f6c64657201"
      "61792e6d73632e6c69737473656374696f6e2e6974656d2e636f6e74726f6c6c65722e44"
      "6976696465724974656d446174614d6f64656c01");
}

static std::vector<std::string> buildSubtree(const std::string& prefix,
                                             char seed,
                                             int size) {
  std::vector<std::string> names;
  for (int c = (unsigned char)seed; size > 0; size--, c++) {
    names.push_back(prefix + c);
  }

  return names;
}

TEST_F(StringTreeTest, testSubtreeOfDifferentSize) {
  char seed = 33;
  int max_char_count = 63;
  std::vector<std::string> names =
      buildSubtree("com.", seed, max_char_count - 1);
  int size = 1;
  // construct subtree of different sizes.
  std::vector<std::string> tmp;
  for (const auto& s : names) {
    if (size >= max_char_count) continue;
    auto subtree = buildSubtree(s, seed, size++);
    tmp.insert(tmp.end(), subtree.begin(), subtree.end());
  }
  names.insert(names.end(), tmp.begin(), tmp.end());

  std::string encoded = StringTreeSet::encode_string_tree_set(names);

  std::string hex = toHexRepresentation(encoded);

  std::cout << hex << std::endl;

  EXPECT_EQ(
      hex,
      "636f6d2e1f7c2122010301230903012416030125280301263f0301275b0301287c030129"
      "2304012a4e04012b7e04012c3405012d6e05012e2e06012f720601303d0701310d080132"
      "610801333b0901341a0a01357d0a0136660b0137540c0138470d01393f0e013a3c0f013b"
      "3e10013c4511013d5112013e6213013f78140140141601413417014259180143041a0144"
      "331b0145671c0146211e01475f1f0148232101496b22014a3924014b0c26014c6327014d"
      "4029014e222b014f092d0150742e0151653001525b32015356340154563601555b380156"
      "653a0157743c0158093f01592241015a4043015b6345015c0c48015d394a015e6b4c0103"
      "210105212208030101010721221403012315030101010109212225030123260301242703"
      "01010101010b21223b0301233c0301243d0301253e030101010101010d21225603012357"
      "03012458030125590301265a03010101010101010f212276030123770301247803012579"
      "0301267a0301277b0301010101010101011121221c0401231d0401241e0401251f040126"
      "200401272104012822040101010101010101011321224604012347040124480401254904"
      "01264a0401274b0401284c0401294d040101010101010101010115212275040123760401"
      "247704012578040126790401277a0401287b0401297c04012a7d04010101010101010101"
      "01011721222a0501232b0501242c0501252d0501262e0501272f05012830050129310501"
      "2a3205012b33050101010101010101010101011921226305012364050124650501256605"
      "01266705012768050128690501296a05012a6b05012b6c05012c6d050101010101010101"
      "01010101011b212222060123230601242406012525060126260601272706012828060129"
      "2906012a2a06012b2b06012c2c06012d2d0601010101010101010101010101011d212265"
      "060123660601246706012568060126690601276a0601286b0601296c06012a6d06012b6e"
      "06012c6f06012d7006012e71060101010101010101010101010101011f1f21222f070123"
      "3007012431070125320701263307012734070128350701293607012a3707012b3807012c"
      "3907012d3a07012e3b07012f3c07010101010101010101010101010101011f2121227d07"
      "01237e0701247f070125010801260208012703080128040801290508012a0608012b0708"
      "012c0808012d0908012e0a08012f0b0801300c0801010101010101010101010101010101"
      "011f23212251080123520801245308012554080126550801275608012857080129580801"
      "2a5908012b5a08012c5b08012d5c08012e5d08012f5e0801305f08013160080101010101"
      "010101010101010101010101011f2521222a0901232b0901242c0901252d0901262e0901"
      "272f090128300901293109012a3209012b3309012c3409012d3509012e3609012f370901"
      "3038090131390901323a09010101010101010101010101010101010101011f272122080a"
      "0123090a01240a0a01250b0a01260c0a01270d0a01280e0a01290f0a012a100a012b110a"
      "012c120a012d130a012e140a012f150a0130160a0131170a0132180a0133190a01010101"
      "010101010101010101010101010101011f2921226a0a01236b0a01246c0a01256d0a0126"
      "6e0a01276f0a0128700a0129710a012a720a012b730a012c740a012d750a012e760a012f"
      "770a0130780a0131790a01327a0a01337b0a01347c0a0101010101010101010101010101"
      "010101010101011f2b2122520b0123530b0124540b0125550b0126560b0127570b012858"
      "0b0129590b012a5a0b012b5b0b012c5c0b012d5d0b012e5e0b012f5f0b0130600b013161"
      "0b0132620b0133630b0134640b0135650b01010101010101010101010101010101010101"
      "0101011f2d21223f0c0123400c0124410c0125420c0126430c0127440c0128450c012946"
      "0c012a470c012b480c012c490c012d4a0c012e4b0c012f4c0c01304d0c01314e0c01324f"
      "0c0133500c0134510c0135520c0136530c01010101010101010101010101010101010101"
      "010101011f2f2122310d0123320d0124330d0125340d0126350d0127360d0128370d0129"
      "380d012a390d012b3a0d012c3b0d012d3c0d012e3d0d012f3e0d01303f0d0131400d0132"
      "410d0133420d0134430d0135440d0136450d0137460d0101010101010101010101010101"
      "010101010101010101011f312122280e0123290e01242a0e01252b0e01262c0e01272d0e"
      "01282e0e01292f0e012a300e012b310e012c320e012d330e012e340e012f350e0130360e"
      "0131370e0132380e0133390e01343a0e01353b0e01363c0e01373d0e01383e0e01010101"
      "0101010101010101010101010101010101010101011f332122240f0123250f0124260f01"
      "25270f0126280f0127290f01282a0f01292b0f012a2c0f012b2d0f012c2e0f012d2f0f01"
      "2e300f012f310f0130320f0131330f0132340f0133350f0134360f0135370f0136380f01"
      "37390f01383a0f01393b0f01010101010101010101010101010101010101010101010101"
      "011f35212225100123261001242710012528100126291001272a1001282b1001292c1001"
      "2a2d10012b2e10012c2f10012d3010012e3110012f321001303310013134100132351001"
      "33361001343710013538100136391001373a1001383b1001393c10013a3d100101010101"
      "010101010101010101010101010101010101010101011f3721222b1101232c1101242d11"
      "01252e1101262f11012730110128311101293211012a3311012b3411012c3511012d3611"
      "012e3711012f38110130391101313a1101323b1101333c1101343d1101353e1101363f11"
      "013740110138411101394211013a4311013b441101010101010101010101010101010101"
      "0101010101010101010101011f392122361201233712012438120125391201263a120127"
      "3b1201283c1201293d12012a3e12012b3f12012c4012012d4112012e4212012f43120130"
      "4412013145120132461201334712013448120135491201364a1201374b1201384c120139"
      "4d12013a4e12013b4f12013c501201010101010101010101010101010101010101010101"
      "010101010101011f3b2122461301234713012448130125491301264a1301274b1301284c"
      "1301294d13012a4e13012b4f13012c5013012d5113012e5213012f531301305413013155"
      "130132561301335713013458130135591301365a1301375b1301385c1301395d13013a5e"
      "13013b5f13013c6013013d61130101010101010101010101010101010101010101010101"
      "010101010101011f3d21225b1401235c1401245d1401255e1401265f1401276014012861"
      "1401296214012a6314012b6414012c6514012d6614012e6714012f68140130691401316a"
      "1401326b1401336c1401346d1401356e1401366f14013770140138711401397214013a73"
      "14013b7414013c7514013d7614013e771401010101010101010101010101010101010101"
      "0101010101010101010101011f3f21227515012376150124771501257815012679150127"
      "7a1501287b1501297c15012a7d15012b7e15012c7f15012d0116012e0216012f03160130"
      "0416013105160132061601330716013408160135091601360a1601370b1601380c160139"
      "0d16013a0e16013b0f16013c1016013d1116013e1216013f131601010101010101010101"
      "010101010101010101010101010101010101010101011f41212215170123161701241717"
      "012518170126191701271a1701281b1701291c17012a1d17012b1e17012c1f17012d2017"
      "012e2117012f221701302317013124170132251701332617013427170135281701362917"
      "01372a1701382b1701392c17013a2d17013b2e17013c2f17013d3017013e3117013f3217"
      "014033170101010101010101010101010101010101010101010101010101010101010101"
      "011f432122391801233a1801243b1801253c1801263d1801273e1801283f180129401801"
      "2a4118012b4218012c4318012d4418012e4518012f461801304718013148180132491801"
      "334a1801344b1801354c1801364d1801374e1801384f1801395018013a5118013b521801"
      "3c5318013d5418013e5518013f5618014057180141581801010101010101010101010101"
      "0101010101010101010101010101010101010101011f4521226219012363190124641901"
      "25651901266619012767190128681901296919012a6a19012b6b19012c6c19012d6d1901"
      "2e6e19012f6f190130701901317119013272190133731901347419013575190136761901"
      "3777190138781901397919013a7a19013b7b19013c7c19013d7d19013e7e19013f7f1901"
      "40011a0141021a0142031a01010101010101010101010101010101010101010101010101"
      "010101010101010101011f472122111b0123121b0124131b0125141b0126151b0127161b"
      "0128171b0129181b012a191b012b1a1b012c1b1b012d1c1b012e1d1b012f1e1b01301f1b"
      "0131201b0132211b0133221b0134231b0135241b0136251b0137261b0138271b0139281b"
      "013a291b013b2a1b013c2b1b013d2c1b013e2d1b013f2e1b01402f1b0141301b0142311b"
      "0143321b0101010101010101010101010101010101010101010101010101010101010101"
      "010101011f492122441c0123451c0124461c0125471c0126481c0127491c01284a1c0129"
      "4b1c012a4c1c012b4d1c012c4e1c012d4f1c012e501c012f511c0130521c0131531c0132"
      "541c0133551c0134561c0135571c0136581c0137591c01385a1c01395b1c013a5c1c013b"
      "5d1c013c5e1c013d5f1c013e601c013f611c0140621c0141631c0142641c0143651c0144"
      "661c01010101010101010101010101010101010101010101010101010101010101010101"
      "0101011f4b21227c1d01237d1d01247e1d01257f1d0126011e0127021e0128031e012904"
      "1e012a051e012b061e012c071e012d081e012e091e012f0a1e01300b1e01310c1e01320d"
      "1e01330e1e01340f1e0135101e0136111e0137121e0138131e0139141e013a151e013b16"
      "1e013c171e013d181e013e191e013f1a1e01401b1e01411c1e01421d1e01431e1e01441f"
      "1e0145201e01010101010101010101010101010101010101010101010101010101010101"
      "010101010101011f4d21223a1f01233b1f01243c1f01253d1f01263e1f01273f1f012840"
      "1f0129411f012a421f012b431f012c441f012d451f012e461f012f471f0130481f013149"
      "1f01324a1f01334b1f01344c1f01354d1f01364e1f01374f1f0138501f0139511f013a52"
      "1f013b531f013c541f013d551f013e561f013f571f0140581f0141591f01425a1f01435b"
      "1f01445c1f01455d1f01465e1f0101010101010101010101010101010101010101010101"
      "010101010101010101010101010101011f4f21227c2001237d2001247e2001257f200126"
      "0121012702210128032101290421012a0521012b0621012c0721012d0821012e0921012f"
      "0a2101300b2101310c2101320d2101330e2101340f210135102101361121013712210138"
      "132101391421013a1521013b1621013c1721013d1821013e1921013f1a2101401b210141"
      "1c2101421d2101431e2101441f2101452021014621210147222101010101010101010101"
      "0101010101010101010101010101010101010101010101010101010101011f5121224422"
      "012345220124462201254722012648220127492201284a2201294b22012a4c22012b4d22"
      "012c4e22012d4f22012e5022012f51220130522201315322013254220133552201345622"
      "01355722013658220137592201385a2201395b22013a5c22013b5d22013c5e22013d5f22"
      "013e6022013f612201406222014163220142642201436522014466220145672201466822"
      "0147692201486a2201010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101011f53212211240123122401241324012514240126152401"
      "2716240128172401291824012a1924012b1a24012c1b24012d1c24012e1d24012f1e2401"
      "301f24013120240132212401332224013423240135242401362524013726240138272401"
      "392824013a2924013b2a24013c2b24013d2c24013e2d24013f2e2401402f240141302401"
      "423124014332240144332401453424014635240147362401483724014938240101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "011f55212262250123632501246425012565250126662501276725012868250129692501"
      "2a6a25012b6b25012c6c25012d6d25012e6e25012f6f2501307025013171250132722501"
      "337325013474250135752501367625013777250138782501397925013a7a25013b7b2501"
      "3c7c25013d7d25013e7e25013f7f25014001260141022601420326014304260144052601"
      "45062601460726014708260148092601490a26014a0b2601010101010101010101010101"
      "0101010101010101010101010101010101010101010101010101010101011f5721223927"
      "01233a2701243b2701253c2701263d2701273e2701283f2701294027012a4127012b4227"
      "012c4327012d4427012e4527012f462701304727013148270132492701334a2701344b27"
      "01354c2701364d2701374e2701384f2701395027013a5127013b5227013c5327013d5427"
      "013e5527013f562701405727014158270142592701435a2701445b2701455c2701465d27"
      "01475e2701485f2701496027014a6127014b622701010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101011f59212215290123"
      "162901241729012518290126192901271a2901281b2901291c29012a1d29012b1e29012c"
      "1f29012d2029012e2129012f222901302329013124290132252901332629013427290135"
      "28290136292901372a2901382b2901392c29013a2d29013b2e29013c2f29013d3029013e"
      "3129013f3229014033290141342901423529014336290144372901453829014639290147"
      "3a2901483b2901493c29014a3d29014b3e29014c3f290101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101011f5b212275"
      "2a0123762a0124772a0125782a0126792a01277a2a01287b2a01297c2a012a7d2a012b7e"
      "2a012c7f2a012d012b012e022b012f032b0130042b0131052b0132062b0133072b013408"
      "2b0135092b01360a2b01370b2b01380c2b01390d2b013a0e2b013b0f2b013c102b013d11"
      "2b013e122b013f132b0140142b0141152b0142162b0143172b0144182b0145192b01461a"
      "2b01471b2b01481c2b01491d2b014a1e2b014b1f2b014c202b014d212b01010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "0101011f5d21225b2c01235c2c01245d2c01255e2c01265f2c0127602c0128612c012962"
      "2c012a632c012b642c012c652c012d662c012e672c012f682c0130692c01316a2c01326b"
      "2c01336c2c01346d2c01356e2c01366f2c0137702c0138712c0139722c013a732c013b74"
      "2c013c752c013d762c013e772c013f782c0140792c01417a2c01427b2c01437c2c01447d"
      "2c01457e2c01467f2c0147012d0148022d0149032d014a042d014b052d014c062d014d07"
      "2d014e082d01010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101011f5f2122462e0123472e0124482e0125492e0126"
      "4a2e01274b2e01284c2e01294d2e012a4e2e012b4f2e012c502e012d512e012e522e012f"
      "532e0130542e0131552e0132562e0133572e0134582e0135592e01365a2e01375b2e0138"
      "5c2e01395d2e013a5e2e013b5f2e013c602e013d612e013e622e013f632e0140642e0141"
      "652e0142662e0143672e0144682e0145692e01466a2e01476b2e01486c2e01496d2e014a"
      "6e2e014b6f2e014c702e014d712e014e722e014f732e0101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101011f61"
      "2122363001233730012438300125393001263a3001273b3001283c3001293d30012a3e30"
      "012b3f30012c4030012d4130012e4230012f433001304430013145300132463001334730"
      "013448300135493001364a3001374b3001384c3001394d30013a4e30013b4f30013c5030"
      "013d5130013e5230013f5330014054300141553001425630014357300144583001455930"
      "01465a3001475b3001485c3001495d30014a5e30014b5f30014c6030014d6130014e6230"
      "014f63300150643001010101010101010101010101010101010101010101010101010101"
      "0101010101010101010101010101010101010101011f6321222b3201232c3201242d3201"
      "252e3201262f32012730320128313201293232012a3332012b3432012c3532012d363201"
      "2e3732012f38320130393201313a3201323b3201333c3201343d3201353e3201363f3201"
      "3740320138413201394232013a4332013b4432013c4532013d4632013e4732013f483201"
      "40493201414a3201424b3201434c3201444d3201454e3201464f32014750320148513201"
      "495232014a5332014b5432014c5532014d5632014e5732014f58320150593201515a3201"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101011f65212225340123263401242734012528340126293401"
      "272a3401282b3401292c34012a2d34012b2e34012c2f34012d3034012e3134012f323401"
      "30333401313434013235340133363401343734013538340136393401373a3401383b3401"
      "393c34013a3d34013b3e34013c3f34013d4034013e4134013f4234014043340141443401"
      "4245340143463401444734014548340146493401474a3401484b3401494c34014a4d3401"
      "4b4e34014c4f34014d5034014e5134014f52340150533401515434015255340101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101011f67212224360123253601242636012527360126283601272936"
      "01282a3601292b36012a2c36012b2d36012c2e36012d2f36012e3036012f313601303236"
      "0131333601323436013335360134363601353736013638360137393601383a3601393b36"
      "013a3c36013b3d36013c3e36013d3f36013e4036013f4136014042360141433601424436"
      "014345360144463601454736014648360147493601484a3601494b36014a4c36014b4d36"
      "014c4e36014d4f36014e5036014f51360150523601515336015254360153553601010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "0101010101010101010101011f69212228380123293801242a3801252b3801262c380127"
      "2d3801282e3801292f38012a3038012b3138012c3238012d3338012e3438012f35380130"
      "363801313738013238380133393801343a3801353b3801363c3801373d3801383e380139"
      "3f38013a4038013b4138013c4238013d4338013e4438013f453801404638014147380142"
      "48380143493801444a3801454b3801464c3801474d3801484e3801494f38014a5038014b"
      "5138014c5238014d5338014e5438014f5538015056380151573801525838015359380154"
      "5a3801010101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101011f6b2122313a0123323a0124333a012534"
      "3a0126353a0127363a0128373a0129383a012a393a012b3a3a012c3b3a012d3c3a012e3d"
      "3a012f3e3a01303f3a0131403a0132413a0133423a0134433a0135443a0136453a013746"
      "3a0138473a0139483a013a493a013b4a3a013c4b3a013d4c3a013e4d3a013f4e3a01404f"
      "3a0141503a0142513a0143523a0144533a0145543a0146553a0147563a0148573a014958"
      "3a014a593a014b5a3a014c5b3a014d5c3a014e5d3a014f5e3a01505f3a0151603a015261"
      "3a0153623a0154633a0155643a0101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101011f6d21223f"
      "3c0123403c0124413c0125423c0126433c0127443c0128453c0129463c012a473c012b48"
      "3c012c493c012d4a3c012e4b3c012f4c3c01304d3c01314e3c01324f3c0133503c013451"
      "3c0135523c0136533c0137543c0138553c0139563c013a573c013b583c013c593c013d5a"
      "3c013e5b3c013f5c3c01405d3c01415e3c01425f3c0143603c0144613c0145623c014663"
      "3c0147643c0148653c0149663c014a673c014b683c014c693c014d6a3c014e6b3c014f6c"
      "3c01506d3c01516e3c01526f3c0153703c0154713c0155723c0156733c01010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "0101010101010101010101011f6f2122523e0123533e0124543e0125553e0126563e0127"
      "573e0128583e0129593e012a5a3e012b5b3e012c5c3e012d5d3e012e5e3e012f5f3e0130"
      "603e0131613e0132623e0133633e0134643e0135653e0136663e0137673e0138683e0139"
      "693e013a6a3e013b6b3e013c6c3e013d6d3e013e6e3e013f6f3e0140703e0141713e0142"
      "723e0143733e0144743e0145753e0146763e0147773e0148783e0149793e014a7a3e014b"
      "7b3e014c7c3e014d7d3e014e7e3e014f7f3e0150013f0151023f0152033f0153043f0154"
      "053f0155063f0156073f0157083f01010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101011f71"
      "21226a4001236b4001246c4001256d4001266e4001276f400128704001297140012a7240"
      "012b7340012c7440012d7540012e7640012f7740013078400131794001327a4001337b40"
      "01347c4001357d4001367e4001377f400138014101390241013a0341013b0441013c0541"
      "013d0641013e0741013f08410140094101410a4101420b4101430c4101440d4101450e41"
      "01460f41014710410148114101491241014a1341014b1441014c1541014d1641014e1741"
      "014f18410150194101511a4101521b4101531c4101541d4101551e4101561f4101572041"
      "015821410101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101011f73212208430123094301"
      "240a4301250b4301260c4301270d4301280e4301290f43012a1043012b1143012c124301"
      "2d1343012e1443012f15430130164301311743013218430133194301341a4301351b4301"
      "361c4301371d4301381e4301391f43013a2043013b2143013c2243013d2343013e244301"
      "3f25430140264301412743014228430143294301442a4301452b4301462c4301472d4301"
      "482e4301492f43014a3043014b3143014c3243014d3343014e3443014f35430150364301"
      "513743015238430153394301543a4301553b4301563c4301573d4301583e4301593f4301"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "0101010101010101010101010101010101010101011f7521222a4501232b4501242c4501"
      "252d4501262e4501272f450128304501293145012a3245012b3345012c3445012d354501"
      "2e3645012f3745013038450131394501323a4501333b4501343c4501353d4501363e4501"
      "373f450138404501394145013a4245013b4345013c4445013d4545013e4645013f474501"
      "4048450141494501424a4501434b4501444c4501454d4501464e4501474f450148504501"
      "495145014a5245014b5345014c5445014d5545014e5645014f5745015058450151594501"
      "525a4501535b4501545c4501555d4501565e4501575f450158604501596145015a624501"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101011f77212251470123524701245347"
      "0125544701265547012756470128574701295847012a5947012b5a47012c5b47012d5c47"
      "012e5d47012f5e4701305f47013160470132614701336247013463470135644701366547"
      "013766470138674701396847013a6947013b6a47013c6b47013d6c47013e6d47013f6e47"
      "01406f470141704701427147014372470144734701457447014675470147764701487747"
      "01497847014a7947014b7a47014c7b47014d7c47014e7d47014f7e4701507f4701510148"
      "0152024801530348015404480155054801560648015707480158084801590948015a0a48"
      "015b0b480101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101011f7921227d490123"
      "7e4901247f490125014a0126024a0127034a0128044a0129054a012a064a012b074a012c"
      "084a012d094a012e0a4a012f0b4a01300c4a01310d4a01320e4a01330f4a0134104a0135"
      "114a0136124a0137134a0138144a0139154a013a164a013b174a013c184a013d194a013e"
      "1a4a013f1b4a01401c4a01411d4a01421e4a01431f4a0144204a0145214a0146224a0147"
      "234a0148244a0149254a014a264a014b274a014c284a014d294a014e2a4a014f2b4a0150"
      "2c4a01512d4a01522e4a01532f4a0154304a0155314a0156324a0157334a0158344a0159"
      "354a015a364a015b374a015c384a01010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "0101011f7b21222f4c0123304c0124314c0125324c0126334c0127344c0128354c012936"
      "4c012a374c012b384c012c394c012d3a4c012e3b4c012f3c4c01303d4c01313e4c01323f"
      "4c0133404c0134414c0135424c0136434c0137444c0138454c0139464c013a474c013b48"
      "4c013c494c013d4a4c013e4b4c013f4c4c01404d4c01414e4c01424f4c0143504c014451"
      "4c0145524c0146534c0147544c0148554c0149564c014a574c014b584c014c594c014d5a"
      "4c014e5b4c014f5c4c01505d4c01515e4c01525f4c0153604c0154614c0155624c015663"
      "4c0157644c0158654c0159664c015a674c015b684c015c694c015d6a4c01010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101011f7d2122654e0123664e0124674e012568"
      "4e0126694e01276a4e01286b4e01296c4e012a6d4e012b6e4e012c6f4e012d704e012e71"
      "4e012f724e0130734e0131744e0132754e0133764e0134774e0135784e0136794e01377a"
      "4e01387b4e01397c4e013a7d4e013b7e4e013c7f4e013d014f013e024f013f034f014004"
      "4f0141054f0142064f0143074f0144084f0145094f01460a4f01470b4f01480c4f01490d"
      "4f014a0e4f014b0f4f014c104f014d114f014e124f014f134f0150144f0151154f015216"
      "4f0153174f0154184f0155194f01561a4f01571b4f01581c4f01591d4f015a1e4f015b1f"
      "4f015c204f015d214f015e224f0101010101010101010101010101010101010101010101"
      "010101010101010101010101010101010101010101010101010101010101010101010101"
      "01010101");
}

TEST_F(StringTreeTest, testSSS) {
  std::string encoded = StringTreeSet::encode_string_tree_set({"sss"});

  std::string hex = toHexRepresentation(encoded);

  std::cout << hex << std::endl;
  EXPECT_EQ(hex, "73737301");
}
